<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Fodevarer til afhentning</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>

<!-- side hoved med titel -->
<header class="topbar">
    <h1>Fodevarer til afhentning</h1>
    <p class="subtitle">Opret, rediger og fjern overskydende mad</p>
</header>

<!-- container til alt indhold -->
<main class="container">

    <!-- knap som printer siden -->
    <button class="btn ghost" type="button" onclick="window.print()">Print</button>

    <!-- filter box med check felter -->
    <form method="get" class="card filters">
        <label class="chip">
            <input type="checkbox" name="category" value="vegansk"
                   th:checked="${activeCategories.contains('vegansk')}"> <span>Vegansk</span>
        </label>

        <label class="chip">
            <input type="checkbox" name="category" value="vegetarisk"
                   th:checked="${activeCategories.contains('vegetarisk')}"> <span>Vegetarisk</span>
        </label>

        <label class="chip">
            <input type="checkbox" name="category" value="andet"
                   th:checked="${activeCategories.contains('andet')}"> <span>Andet</span>
        </label>

        <!-- sok felt til mad -->
        <input class="search" type="search" name="q" placeholder="Sog…" th:value="${q}">
        <button class="btn primary" type="submit">Filtrer</button>
    </form>

    <!-- form til at lave eller redigere mad -->
    <section class="card">
        <h2 th:text="${form.id} != null ? 'Rediger fodevare' : 'Opret fodevare'"></h2>

        <form action="/save" method="post" class="form">
            <input type="hidden" name="id" th:value="${form.id}">

            <div class="grid">
                <!-- felt til mad navn -->
                <label>
                    <span>Navn</span>
                    <input name="name" th:value="${form.name}" required placeholder="Fx 'Rugbrod - 2 stk.'">
                </label>

                <!-- felt til antal -->
                <label>
                    <span>Antal (stk/portioner)</span>
                    <input type="number" name="qty" min="1" step="1" th:value="${form.qty ?: 1}" required>
                </label>

                <!-- felt til kilo -->
                <label>
                    <span>Antal kg</span>
                    <input type="number" name="kg" step="0.1" min="0" th:value="${form.kg}">
                </label>

                <!-- felt til pris -->
                <label>
                    <span>Pris (kr)</span>
                    <input type="number" name="price" step="0.5" min="0" th:value="${form.price}">
                </label>

                <!-- felt til kategori -->
                <label>
                    <span>Kategori</span>
                    <select name="category" th:value="${form.category}">
                        <option value="vegansk">Vegansk</option>
                        <option value="vegetarisk">Vegetarisk</option>
                        <option value="andet">Andet</option>
                    </select>
                </label>

                <!-- felt til afhentningstid -->
                <label>
                    <span>Afhentningstid</span>
                    <input type="datetime-local" name="pickup"
                           th:value="${form.pickup != null ? form.pickup.toString().substring(0,16) : ''}">
                </label>

                <!-- felt til beskrivelse -->
                <label class="full">
                    <span>Beskrivelse</span>
                    <textarea name="desc" rows="2" placeholder="Allergener, bedst for, osv."
                              th:text="${form.desc}"></textarea>
                </label>
            </div>

            <!-- knapper til at gemme og nulstille form -->
            <div class="actions">
                <button class="btn primary" type="submit">Gem</button>
                <a href="/" class="btn ghost">Nulstil</a>
            </div>
        </form>
    </section>

    <!-- liste som viser mad -->
    <section class="card">
        <div class="list-head">
            <h2>Tilgaengelige fodevarer</h2>
            <small id="count" th:text="${count + ' element' + (count == 1 ? '' : 'er')}"></small>
        </div>

        <!-- hver linje er en mad vare -->
        <ul class="list">
            <li class="item" th:each="f : ${items}">
                <!-- navn + beskrivelse -->
                <div>
                    <h3 th:text="${f.name}">Navn</h3>
                    <div class="meta desc" th:text="${f.desc}">Beskrivelse</div>
                </div>

                <div class="badge" th:text="${f.category}">kategori</div>
                <div class="qty">Antal: <strong th:text="${f.qty}">1</strong></div>
                <div class="qty">Kg: <strong th:text="${f.kg}">0</strong></div>
                <div class="qty">Pris: <strong th:text="${f.price}">0</strong> kr</div>

                <!-- tid for afhentning -->
                <div class="pickup"
                     th:text="${f.pickup != null ? #temporals.format(f.pickup,'dd/MM HH:mm') : 'Ingen tid'}">
                </div>

                <!-- knapper til at redigere eller slette mad -->
                <div class="controls">
                    <a class="btn small" th:href="@{'/edit/' + ${f.id}}">Rediger</a>
                    <form th:action="@{'/delete/' + ${f.id}}" method="post"
                          onsubmit="return confirm('Slet dette?')">
                        <button class="btn small warn" type="submit">Slet</button>
                    </form>
                </div>
            </li>
        </ul>
    </section>

</main>

<!-- footer med lille tekst -->
<footer class="footer">
    <small> Stot lokalt • Forebyg spilde • Mindsk okonomi tab</small>
</footer>

</body>
</html>
